<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Array wrappers · PencilArrays.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://jipolanco.github.io/PencilArrays.jl/PencilArrays/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../assets/tomate.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PencilArrays.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PencilArrays.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../MPITopology/">MPI topology</a></li><li><a class="tocitem" href="../Pencils/">Pencil configurations</a></li><li class="is-active"><a class="tocitem" href>Array wrappers</a><ul class="internal"><li><a class="tocitem" href="#Construction"><span>Construction</span></a></li><li><a class="tocitem" href="#Dimension-permutations"><span>Dimension permutations</span></a></li><li><a class="tocitem" href="#Global-views"><span>Global views</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Methods"><span>Methods</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li><li><a class="tocitem" href="../Transpositions/">Global MPI operations</a></li><li><a class="tocitem" href="../PencilIO/">Parallel I/O</a></li><li><a class="tocitem" href="../PencilArrays_timers/">Measuring performance</a></li></ul></li><li><span class="tocitem">Additional notes</span><ul><li><a class="tocitem" href="../notes/reductions/">Reductions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Array wrappers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Array wrappers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jipolanco/PencilArrays.jl/blob/master/docs/src/PencilArrays.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PencilArrays_module"><a class="docs-heading-anchor" href="#PencilArrays_module">Array wrappers</a><a id="PencilArrays_module-1"></a><a class="docs-heading-anchor-permalink" href="#PencilArrays_module" title="Permalink"></a></h1><p>The <code>PencilArrays</code> module defines types for handling MPI-distributed data.</p><p>The most important types are:</p><ul><li><p><a href="#PencilArrays.PencilArray"><code>PencilArray</code></a>: array wrapper including MPI decomposition information. Takes <em>local</em> indices starting at 1, regardless of the location of each MPI process on the global topology.</p></li><li><p><a href="#PencilArrays.GlobalPencilArray"><code>GlobalPencilArray</code></a>: <code>PencilArray</code> wrapper that takes <em>global</em> indices, which generally don&#39;t start at 1. See also <a href="#Global-views">Global views</a>.</p></li></ul><h2 id="Construction"><a class="docs-heading-anchor" href="#Construction">Construction</a><a id="Construction-1"></a><a class="docs-heading-anchor-permalink" href="#Construction" title="Permalink"></a></h2><p>An uninitialised <code>PencilArray</code> can be constructed from a <a href="../Pencils/#PencilArrays.Pencils.Pencil"><code>Pencil</code></a> instance as</p><pre><code class="language-julia hljs">pencil = Pencil(#= ... =#)
A = PencilArray{Float64}(undef, pencil)
parent(A)  # returns the Array wrapped by `A`</code></pre><p>This allocates a new <code>Array</code> with the local dimensions and data type associated to the <code>Pencil</code>.</p><p>One can also construct a <code>PencilArray</code> wrapper from an existing <code>AbstractArray</code>, whose dimensions must be compatible with the <code>Pencil</code> configuration. For instance, the following works:</p><pre><code class="language-julia hljs">dims = size_local(pencil, MemoryOrder())  # dimensions must be in memory order!
data = zeros(dims)
A = PencilArray(pencil, data)</code></pre><p>Note that <code>data</code> does not need to be a <code>Array</code>, but can be any subtype of <code>AbstractArray</code>.</p><p>It is also possible to construct higher dimensional arrays, as in:</p><pre><code class="language-julia hljs">data = zeros(dims..., 3, 2)
A = PencilArray(pencil, data)</code></pre><p>This will construct a <code>PencilArray</code> where the rightmost dimensions (called <em>extra dimensions</em> in the PencilArrays API) will never be split among MPI processes.</p><h2 id="Dimension-permutations"><a class="docs-heading-anchor" href="#Dimension-permutations">Dimension permutations</a><a id="Dimension-permutations-1"></a><a class="docs-heading-anchor-permalink" href="#Dimension-permutations" title="Permalink"></a></h2><p>Unlike the wrapped <code>AbstractArray</code>, the <code>PencilArray</code> wrapper takes indices in logical order. For instance, if the underlying permutation of the <code>Pencil</code> is <code>(2, 3, 1)</code>, then <code>A[i, j, k]</code> points to the same value as <code>parent(A)[j, k, i]</code>.</p><h2 id="Global-views"><a class="docs-heading-anchor" href="#Global-views">Global views</a><a id="Global-views-1"></a><a class="docs-heading-anchor-permalink" href="#Global-views" title="Permalink"></a></h2><p><code>PencilArray</code>s are accessed using local indices that start at 1, regardless of the location of the subdomain associated to the local process on the global grid. Sometimes it may be more convenient to use global indices describing the position of the local process in the domain. For this, the <a href="#PencilArrays.global_view-Tuple{PencilArray}"><code>global_view</code></a> function is provided that generates an <a href="https://github.com/JuliaArrays/OffsetArrays.jl"><code>OffsetArray</code></a> wrapper taking global indices.</p><p>For more details, see for instance <a href="https://jipolanco.github.io/PencilFFTs.jl/stable/examples/gradient/#gradient_method_global">the gradient example</a> in the PencilFFTs docs.</p><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.PencilArray" href="#PencilArrays.PencilArray"><code>PencilArrays.PencilArray</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PencilArray(pencil::Pencil, data::AbstractArray{T,N})</code></pre><p>Create array wrapper with pencil decomposition information.</p><p>The array dimensions and element type must be consistent with those of the given pencil.</p><div class="admonition is-info"><header class="admonition-header">Index permutations</header><div class="admonition-body"><p>If the <code>Pencil</code> has an associated index permutation, then <code>data</code> must have its dimensions permuted accordingly (in <em>memory</em> order).</p><p>Unlike <code>data</code>, the resulting <code>PencilArray</code> should be accessed with unpermuted indices (in <em>logical</em> order).</p><h5>Example</h5><p>Suppose <code>pencil</code> has local dimensions <code>(10, 20, 30)</code> before permutation, and has an asociated permutation <code>(2, 3, 1)</code>. Then:</p><pre><code class="language-julia hljs">data = zeros(20, 30, 10)       # parent array (with dimensions in memory order)

u = PencilArray(pencil, data)  # wrapper with dimensions (10, 20, 30)
@assert size(u) === (10, 20, 30)

u[15, 25, 5]          # BoundsError (15 &gt; 10 and 25 &gt; 20)
u[5, 15, 25]          # correct
parent(u)[15, 25, 5]  # correct
</code></pre></div></div><div class="admonition is-info"><header class="admonition-header">Extra dimensions</header><div class="admonition-body"><p>The data array can have one or more extra dimensions to the right (slow indices), which are not affected by index permutations.</p><h5>Example</h5><pre><code class="language-julia hljs">dims = (20, 30, 10)
PencilArray(pencil, zeros(dims...))        # works (scalar)
PencilArray(pencil, zeros(dims..., 3))     # works (3-component vector)
PencilArray(pencil, zeros(dims..., 4, 3))  # works (4×3 tensor)
PencilArray(pencil, zeros(3, dims...))     # fails</code></pre></div></div><hr/><pre><code class="nohighlight hljs">PencilArray{T}(undef, pencil::Pencil, [extra_dims...])</code></pre><p>Allocate an uninitialised <code>PencilArray</code> that can hold data in the local pencil.</p><p>Extra dimensions, for instance representing vector components, can be specified. These dimensions are added to the rightmost (slowest) indices of the resulting array.</p><p><strong>Example</strong></p><p>Suppose <code>pencil</code> has local dimensions <code>(20, 10, 30)</code>. Then:</p><pre><code class="language-julia hljs">PencilArray{Float64}(undef, pencil)        # array dimensions are (20, 10, 30)
PencilArray{Float64}(undef, pencil, 4, 3)  # array dimensions are (20, 10, 30, 4, 3)</code></pre><p>More examples:</p><pre><code class="language-julia-repl hljs">julia&gt; pen = Pencil((20, 10, 12), MPI.COMM_WORLD);

julia&gt; u = PencilArray{Float64}(undef, pen);

julia&gt; summary(u)
&quot;20×10×12 PencilArray{Float64, 3}(::Pencil{3, 2, NoPermutation})&quot;

julia&gt; PencilArray{Float64}(undef, pen, 4, 3) |&gt; summary
&quot;20×10×12×4×3 PencilArray{Float64, 5}(::Pencil{3, 2, NoPermutation})&quot;
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL1-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.GlobalPencilArray" href="#PencilArrays.GlobalPencilArray"><code>PencilArrays.GlobalPencilArray</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GlobalPencilArray{T,N} &lt;: AbstractArray{T,N}</code></pre><p>Alias for an <code>OffsetArray</code> wrapping a <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a>.</p><p>Unlike <code>PencilArray</code>s, <code>GlobalPencilArray</code>s take <em>global</em> indices, which in general don&#39;t start at 1 for a given MPI process.</p><p>The <a href="#PencilArrays.global_view-Tuple{PencilArray}"><code>global_view</code></a> function should be used to create a <code>GlobalPencilArray</code> from a <code>PencilArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/global_view.jl#LL1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.PencilArrayCollection" href="#PencilArrays.PencilArrayCollection"><code>PencilArrays.PencilArrayCollection</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PencilArrayCollection</code></pre><p><code>UnionAll</code> type describing a collection of <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a>s.</p><p>Such a collection can be a tuple or an array of <code>PencilArray</code>s.</p><p>Collections are <strong>by assumption</strong> homogeneous: each array has the same properties, and in particular, is associated to the same <a href="../Pencils/#PencilArrays.Pencils.Pencil"><code>Pencil</code></a> configuration.</p><p>For convenience, certain operations defined for <code>PencilArray</code> are also defined for <code>PencilArrayCollection</code>, and return the same value as for a single <code>PencilArray</code>. Some examples are <a href="#PencilArrays.pencil-Tuple{PencilArray}"><code>pencil</code></a>, <a href="#PencilArrays.Pencils.range_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>range_local</code></a> and <a href="../MPITopology/#PencilArrays.Pencils.MPITopologies.get_comm-Tuple{MPITopology}"><code>get_comm</code></a>.</p><p>Also note that functions from <code>Base</code>, such as <code>size</code>, <code>ndims</code> and <code>eltype</code>, are <strong>not</strong> overloaded for <code>PencilArrayCollection</code>, since they already have a definition for tuples and arrays (and redefining them would be type piracy...).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL138-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.ManyPencilArray" href="#PencilArrays.ManyPencilArray"><code>PencilArrays.ManyPencilArray</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ManyPencilArray{T,N,M}</code></pre><p>Container holding <code>M</code> different <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a> views to the same underlying data buffer. All views share the same element type <code>T</code> and dimensionality <code>N</code>.</p><p>This can be used to perform in-place data transpositions with <a href="../Transpositions/#LinearAlgebra.transpose!"><code>transpose!</code></a>.</p><hr/><pre><code class="nohighlight hljs">ManyPencilArray{T}(undef, pencils...; extra_dims=())</code></pre><p>Create a <code>ManyPencilArray</code> container that can hold data of type <code>T</code> associated to all the given <a href="../Pencils/#PencilArrays.Pencils.Pencil"><code>Pencil</code></a>s.</p><p>The optional <code>extra_dims</code> argument is the same as for <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/multiarrays.jl#LL1-L19">source</a></section></article><h2 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h2><h3 id="PencilArray"><a class="docs-heading-anchor" href="#PencilArray">PencilArray</a><a id="PencilArray-1"></a><a class="docs-heading-anchor-permalink" href="#PencilArray" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.extra_dims-Tuple{PencilArray}" href="#PencilArrays.extra_dims-Tuple{PencilArray}"><code>PencilArrays.extra_dims</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extra_dims(x::PencilArray)
extra_dims(x::PencilArrayCollection)</code></pre><p>Return tuple with size of &quot;extra&quot; dimensions of <code>PencilArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL412-L417">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.Pencils.MPITopologies.get_comm-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}" href="#PencilArrays.Pencils.MPITopologies.get_comm-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.MPITopologies.get_comm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_comm(x::PencilArray)
get_comm(x::PencilArrayCollection)</code></pre><p>Get MPI communicator associated to a pencil-distributed array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL469-L474">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.Pencils.permutation" href="#PencilArrays.Pencils.permutation"><code>PencilArrays.Pencils.permutation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">permutation(::Type{&lt;:PencilArray})
permutation(x::PencilArray)
permutation(x::PencilArrayCollection)</code></pre><p>Get index permutation associated to the given <code>PencilArray</code>.</p><p>Returns <code>NoPermutation()</code> if there is no associated permutation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL477-L485">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.global_view-Tuple{PencilArray}" href="#PencilArrays.global_view-Tuple{PencilArray}"><code>PencilArrays.global_view</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">global_view(x::PencilArray)</code></pre><p>Create an <a href="https://github.com/JuliaArrays/OffsetArrays.jl"><code>OffsetArray</code></a> of a <code>PencilArray</code> that takes global indices in logical order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/global_view.jl#LL14-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.ndims_extra-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}" href="#PencilArrays.ndims_extra-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.ndims_extra</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ndims_extra(::Type{&lt;:PencilArray})
ndims_extra(x::PencilArray)
ndims_extra(x::PencilArrayCollection)</code></pre><p>Number of &quot;extra&quot; dimensions associated to <code>PencilArray</code>.</p><p>These are the dimensions that are not associated to the domain geometry. For instance, they may correspond to vector or tensor components.</p><p>These dimensions correspond to the rightmost indices of the array.</p><p>The total number of dimensions of a <code>PencilArray</code> is given by:</p><pre><code class="nohighlight hljs">ndims(x) == ndims_space(x) + ndims_extra(x)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL376-L392">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.ndims_space-Tuple{PencilArray}" href="#PencilArrays.ndims_space-Tuple{PencilArray}"><code>PencilArrays.ndims_space</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ndims_space(x::PencilArray)
ndims_space(x::PencilArrayCollection)</code></pre><p>Number of dimensions associated to the domain geometry.</p><p>These dimensions correspond to the leftmost indices of the array.</p><p>The total number of dimensions of a <code>PencilArray</code> is given by:</p><pre><code class="nohighlight hljs">ndims(x) == ndims_space(x) + ndims_extra(x)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL396-L408">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.parent-Tuple{PencilArray}" href="#Base.parent-Tuple{PencilArray}"><code>Base.parent</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">parent(x::PencilArray)</code></pre><p>Return array wrapped by a <code>PencilArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL349-L353">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.pencil-Tuple{PencilArray}" href="#PencilArrays.pencil-Tuple{PencilArray}"><code>PencilArrays.pencil</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pencil(x::PencilArray)</code></pre><p>Return decomposition configuration associated to a <code>PencilArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL341-L345">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.pointer-Tuple{PencilArray}" href="#Base.pointer-Tuple{PencilArray}"><code>Base.pointer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pointer(x::PencilArray)</code></pre><p>Return pointer to the start of the underlying data.</p><p>Use with caution: this may not make a lot of sense if the underlying data is not contiguous or strided (e.g. if the <code>PencilArray</code> is wrapping a non-strided <code>SubArray</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL365-L373">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.Pencils.range_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}" href="#PencilArrays.Pencils.range_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.range_local</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">range_local(x::PencilArray, [order = LogicalOrder()])
range_local(x::PencilArrayCollection, [order = LogicalOrder()])</code></pre><p>Local data range held by the <code>PencilArray</code>.</p><p>By default the dimensions are returned in logical order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL443-L450">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.Pencils.range_remote-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}, Vararg{Any, N} where N}" href="#PencilArrays.Pencils.range_remote-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}, Vararg{Any, N} where N}"><code>PencilArrays.Pencils.range_remote</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">range_remote(x::PencilArray, coords, [order = LogicalOrder()])
range_remote(x::PencilArrayCollection, coords, [order = LogicalOrder()])</code></pre><p>Get data range held by the <code>PencilArray</code> in a given MPI process.</p><p>The location of the MPI process in the topology is determined by the <code>coords</code> argument, which can be given as a linear or Cartesian index.</p><p>See <a href="../Pencils/#PencilArrays.Pencils.range_remote-Tuple{Pencil, Integer, LogicalOrder}"><code>range_remote(::Pencil, ...)</code></a> variant for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL454-L465">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.similar-Tuple{PencilArray}" href="#Base.similar-Tuple{PencilArray}"><code>Base.similar</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">similar(x::PencilArray, [element_type=eltype(x)], [dims])</code></pre><p>Returns an array similar to <code>x</code>.</p><p>The actual type of the returned array depends on whether <code>dims</code> is passed:</p><ul><li><p>if <code>dims</code> is <em>not</em> passed, then a <code>PencilArray</code> of same dimensions of <code>x</code> is returned.</p></li><li><p>otherwise, an array similar to that wrapped by <code>x</code> (typically a regular <code>Array</code>) is returned, with the chosen dimensions.</p></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; pen = Pencil((20, 10, 12), MPI.COMM_WORLD);

julia&gt; u = PencilArray{Float64}(undef, pen);

julia&gt; similar(u) |&gt; summary
&quot;20×10×12 PencilArray{Float64, 3}(::Pencil{3, 2, NoPermutation})&quot;

julia&gt; similar(u, ComplexF32) |&gt; summary
&quot;20×10×12 PencilArray{ComplexF32, 3}(::Pencil{3, 2, NoPermutation})&quot;

julia&gt; similar(u, (4, 3, 8)) |&gt; summary
&quot;4×3×8 Array{Float64, 3}&quot;

julia&gt; similar(u, (4, 3)) |&gt; summary
&quot;4×3 Matrix{Float64}&quot;

julia&gt; similar(u, ComplexF32) |&gt; summary
&quot;20×10×12 PencilArray{ComplexF32, 3}(::Pencil{3, 2, NoPermutation})&quot;

julia&gt; similar(u, ComplexF32, (4, 3)) |&gt; summary
&quot;4×3 Matrix{ComplexF32}&quot;</code></pre><hr/><pre><code class="nohighlight hljs">similar(x::PencilArray, [element_type = eltype(x)], p::Pencil)</code></pre><p>Create a <code>PencilArray</code> with the decomposition described by the given <code>Pencil</code>.</p><p>This variant may be used to create a <code>PencilArray</code> that has a different decomposition than the input <code>PencilArray</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; pen_u = Pencil((20, 10, 12), (2, 3), MPI.COMM_WORLD);

julia&gt; u = PencilArray{Float64}(undef, pen_u);

julia&gt; pen_v = Pencil(pen_u; decomp_dims = (1, 3), permute = Permutation(2, 3, 1))
Decomposition of 3D data
    Data dimensions: (20, 10, 12)
    Decomposed dimensions: (1, 3)
    Data permutation: Permutation(2, 3, 1)

julia&gt; v = similar(u, pen_v);

julia&gt; summary(v)
&quot;20×10×12 PencilArray{Float64, 3}(::Pencil{3, 2, Permutation{(2, 3, 1), 3}})&quot;

julia&gt; pencil(v) === pen_v
true

julia&gt; vint = similar(u, Int, pen_v);

julia&gt; summary(vint)
&quot;20×10×12 PencilArray{Int64, 3}(::Pencil{3, 2, Permutation{(2, 3, 1), 3}})&quot;

julia&gt; pencil(vint) === pen_v
true
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL205-L283">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.size-Tuple{PencilArray}" href="#Base.size-Tuple{PencilArray}"><code>Base.size</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">size(x::PencilArray)</code></pre><p>Return local dimensions of a <code>PencilArray</code> in logical order.</p><p>Same as <code>size_local(x, LogicalOrder())</code> (see <a href="#PencilArrays.Pencils.size_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>size_local</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL181-L187">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.Pencils.size_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}" href="#PencilArrays.Pencils.size_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.size_local</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">size_local(x::PencilArray, [order = LogicalOrder()])
size_local(x::PencilArrayCollection, [order = LogicalOrder()])</code></pre><p>Local dimensions of the data held by the <code>PencilArray</code>.</p><p>If <code>order = LogicalOrder()</code>, this is the same as <code>size(x)</code>.</p><p>See also <a href="../Pencils/#PencilArrays.Pencils.size_local-Tuple{Pencil, Vararg{Any, N} where N}"><code>size_local(::Pencil)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.Pencils.size_global-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}" href="#PencilArrays.Pencils.size_global-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.size_global</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">size_global(x::PencilArray, [order = LogicalOrder()])
size_global(x::PencilArrayCollection, [order = LogicalOrder()])</code></pre><p>Global dimensions associated to the given array.</p><p>By default, the logical dimensions of the dataset are returned.</p><p>See also <a href="#PencilArrays.Pencils.size_global-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>size_global(::Pencil)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL421-L430">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.sizeof_global-Tuple{PencilArray}" href="#PencilArrays.sizeof_global-Tuple{PencilArray}"><code>PencilArrays.sizeof_global</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sizeof_global(x::PencilArray)
sizeof_global(x::PencilArrayCollection)</code></pre><p>Global size of array in bytes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL434-L439">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PencilArrays.Pencils.topology-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}" href="#PencilArrays.Pencils.topology-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.topology</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">topology(x::PencilArray)
topology(x::PencilArrayCollection)</code></pre><p>Get <a href="../MPITopology/#PencilArrays.Pencils.MPITopologies.MPITopology"><code>MPITopology</code></a> associated to a <code>PencilArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/arrays.jl#LL498-L503">source</a></section></article><h3 id="ManyPencilArray"><a class="docs-heading-anchor" href="#ManyPencilArray">ManyPencilArray</a><a id="ManyPencilArray-1"></a><a class="docs-heading-anchor-permalink" href="#ManyPencilArray" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="Base.first-Tuple{ManyPencilArray}" href="#Base.first-Tuple{ManyPencilArray}"><code>Base.first</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">first(A::ManyPencilArray)</code></pre><p>Returns the first <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a> wrapped by <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/multiarrays.jl#LL65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.getindex-Tuple{ManyPencilArray}" href="#Base.getindex-Tuple{ManyPencilArray}"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">getindex(A::ManyPencilArray, ::Val{i})
getindex(A::ManyPencilArray, i::Integer)</code></pre><p>Returns the i-th <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a> wrapped by <code>A</code>.</p><p>If possible, the <code>Val{i}</code> form should be preferred, as it is more efficient and it allows the compiler to know the return type.</p><p>See also <a href="#Base.first-Tuple{ManyPencilArray}"><code>first(::ManyPencilArray)</code></a>, <a href="#Base.last-Tuple{ManyPencilArray}"><code>last(::ManyPencilArray)</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">A = ManyPencilArray(pencil1, pencil2, pencil3)

# Get the PencilArray associated to `pencil2`.
# u2 = A[2]
u2 = A[Val(2)]  # faster!</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/multiarrays.jl#LL79-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.last-Tuple{ManyPencilArray}" href="#Base.last-Tuple{ManyPencilArray}"><code>Base.last</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">last(A::ManyPencilArray)</code></pre><p>Returns the last <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a> wrapped by <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/multiarrays.jl#LL72-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length-Tuple{ManyPencilArray}" href="#Base.length-Tuple{ManyPencilArray}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">length(A::ManyPencilArray)</code></pre><p>Returns the number of <a href="#PencilArrays.PencilArray"><code>PencilArray</code></a>s wrapped by <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/PencilArrays.jl/blob/3dd4ff4182430f06839e71ab0e851c019bd7407d/src/multiarrays.jl#LL58-L62">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#PencilArrays.GlobalPencilArray"><code>PencilArrays.GlobalPencilArray</code></a></li><li><a href="#PencilArrays.ManyPencilArray"><code>PencilArrays.ManyPencilArray</code></a></li><li><a href="#PencilArrays.PencilArray"><code>PencilArrays.PencilArray</code></a></li><li><a href="#PencilArrays.PencilArrayCollection"><code>PencilArrays.PencilArrayCollection</code></a></li><li><a href="#Base.first-Tuple{ManyPencilArray}"><code>Base.first</code></a></li><li><a href="#Base.getindex-Tuple{ManyPencilArray}"><code>Base.getindex</code></a></li><li><a href="#Base.last-Tuple{ManyPencilArray}"><code>Base.last</code></a></li><li><a href="#Base.length-Tuple{ManyPencilArray}"><code>Base.length</code></a></li><li><a href="#Base.parent-Tuple{PencilArray}"><code>Base.parent</code></a></li><li><a href="#Base.pointer-Tuple{PencilArray}"><code>Base.pointer</code></a></li><li><a href="#Base.similar-Tuple{PencilArray}"><code>Base.similar</code></a></li><li><a href="#Base.size-Tuple{PencilArray}"><code>Base.size</code></a></li><li><a href="#PencilArrays.Pencils.MPITopologies.get_comm-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.MPITopologies.get_comm</code></a></li><li><a href="#PencilArrays.Pencils.permutation"><code>PencilArrays.Pencils.permutation</code></a></li><li><a href="#PencilArrays.Pencils.range_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.range_local</code></a></li><li><a href="#PencilArrays.Pencils.range_remote-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}, Vararg{Any, N} where N}"><code>PencilArrays.Pencils.range_remote</code></a></li><li><a href="#PencilArrays.Pencils.size_global-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.size_global</code></a></li><li><a href="#PencilArrays.Pencils.size_local-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.size_local</code></a></li><li><a href="#PencilArrays.Pencils.topology-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.Pencils.topology</code></a></li><li><a href="#PencilArrays.extra_dims-Tuple{PencilArray}"><code>PencilArrays.extra_dims</code></a></li><li><a href="#PencilArrays.global_view-Tuple{PencilArray}"><code>PencilArrays.global_view</code></a></li><li><a href="#PencilArrays.ndims_extra-Tuple{Union{PencilArray, Union{Tuple{Vararg{A, N} where N}, AbstractArray{A, N} where N} where A&lt;:PencilArray}}"><code>PencilArrays.ndims_extra</code></a></li><li><a href="#PencilArrays.ndims_space-Tuple{PencilArray}"><code>PencilArrays.ndims_space</code></a></li><li><a href="#PencilArrays.pencil-Tuple{PencilArray}"><code>PencilArrays.pencil</code></a></li><li><a href="#PencilArrays.sizeof_global-Tuple{PencilArray}"><code>PencilArrays.sizeof_global</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Pencils/">« Pencil configurations</a><a class="docs-footer-nextpage" href="../Transpositions/">Global MPI operations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Tuesday 2 November 2021 11:05">Tuesday 2 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
